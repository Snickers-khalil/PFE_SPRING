<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarColor02">
        <ul class="navbar-nav mr-auto">
            <!-- <li class="nav-item active">
                <a class="nav-link" (click)="onOpenModal(null!, 'add')">Add Utilisateur<span class="sr-only">(current)</span></a>
            </li> -->
            <form class="form-inline my-2 my-lg-0">
                <input type="search" (ngModelChange)="searchEmployees(key.value)" #key="ngModel" ngModel name="key" id="searchName" class="form-control mr-sm-2" placeholder="Search employees..." required>
                <p >Number of users: {{utilisateurs?.length}}</p>
            </form>
        </ul>
    </div>
</nav>

<div class="container" id="main-container">
    <div class="row">
        <div *ngFor="let utilisateur of utilisateurs" class="col-md-6 col-xl-3">
            <div class="card m-b-30">
                <div class="card-body row">
                    <div class="col-6">
                        <img style="width: 140px; height: 140px;" src="data:image/png;base64,{{utilisateur?.imageUrl}}" class="img-fluid rounded-circle w-60 thumbnail-image" onerror="this.src='./assets/img/per.png'">
                    </div>
                    <div class="col-6 card-title align-self-center mb-0">
                        <h5 style="font-size: medium;">{{utilisateur?.username}}</h5>
                        <p class="m-0"></p>
                    </div>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item" style="font-size: medium;"><i class="fa fa-envelope float-right"></i>E-mail: {{utilisateur?.email}}</li>
                    <li class="list-group-item" style="font-size: medium;"><i class="fa fa-phone float-right"></i>Phone :{{utilisateur?.phone}}</li>
                    <!-- <li class="list-group-item"><i class="fa float-right"></i> -->
                    <!-- <li class="list-group-item float-left" *ngFor="let role of utilisateur.roles">{{ role?.name }} -->
                    <li class="list-group-item"><i class="fa float-right"></i>
                        <a (click)="onOpenModal(utilisateur, 'role')" *ngFor="let role of utilisateur.roles">{{ role?.name }} </a> <br>
                    </li>
                    <!--<li class="list-group-item float-left" *ngFor="let role of utilisateur.roles">{{ role?.name }}-->
                </ul>
                <div class="card-body">
                    <div class="float-right btn-group btn-group-sm">
                        <a (click)="onOpenModal(utilisateur, 'edit')" class="btn btn-primary tooltips" data-placement="top" data-original-title="Edit"><i class="fa fa-pencil"></i> </a>
                        <a (click)="onOpenModal(utilisateur, 'delete')" class="btn btn-secondary tooltips" data-placement="top" data-original-title="Delete"><i class="fa fa-times"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div class="modal fade" id="addEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="addEmployeeModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addEmployeeModalLabel">Add Utlisateur</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
              </button>
                </div>
                <div class="modal-body">
                    <form name="form" (ngSubmit)="f.form.valid && onAddUser(addForm)" #f="ngForm" #addForm="ngForm" novalidate>
                        <div class="form-group">
                            <label>first name</label>
                            <input type="text" name="firstname" class="form-control" placeholder="Enter firstName" [(ngModel)]="form.firstname" required firstname #firstname="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>last name</label>
                            <input type="text" class="form-control" name="lastname" placeholder="Enter LastName " [(ngModel)]="form.lastname " required lastname #lastname="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>Username</label>
                            <input type="text" class="form-control" name="username" placeholder="Enter Username " [(ngModel)]="form.username" required username #username="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>Email address</label>
                            <input type="email" class="form-control" name="email" placeholder=" Enter E-mail " [(ngModel)]="form.email " required email #email="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>Password</label>
                            <input type="password" class="form-control" name="password" placeholder="Password" [(ngModel)]="form.password " required password #password="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>phone</label>
                            <input type="text" class="form-control" name="phone" placeholder="Enter Phone " [(ngModel)]="form.phone " required phone #phone="ngModel">
                        </div>
                        <div class="form-group ">
                            <label>City</label>
                            <input type="text" class="form-control" name="city" placeholder="Enter City " [(ngModel)]="form.city " required city #city="ngModel">
                        </div>
                        <!-- <div class="form-group ">
                            <label>image Url</label>
                            <input type="text" class="form-control" name="imageUrl" placeholder="Enter imageUrl " [(ngModel)]="form.imageUrl " required imageUrl #imageUrl="ngModel">
                        </div> -->
                        <div class="modal-footer">
                            <button type="button" id="add-employee-form" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button [disabled]="addForm.invalid" type="submit" class="btn btn-primary">Add User</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Modal -->
    <div class="modal fade" id="updateEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="employeeEditModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updateEmployeeModalLabel">Edit user {{edituser?.username}}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
               </button>
                </div>
                <div class="modal-body">
                    <form #editForm="ngForm" (ngSubmit)="f.form.valid && onAddUser(addForm)" novalidate>
                        <div class="form-group">
                            <label for="name">Username</label>
                            <input required type="text" ngModel="{{edituser?.username}}" name="username" class="form-control" id="username" aria-describedby="emailHelp" placeholder="username">
                        </div>
                        <div class="form-group">
                            <label for="name">FirstName</label>
                            <input required type="text" ngModel="{{edituser?.firstname}}" name="firstname" class="form-control" id="firstname" aria-describedby="emailHelp" placeholder="firstname">
                        </div>
                        <div class="form-group">
                            <label for="name">LastName</label>
                            <input required type="text" ngModel="{{edituser?.lastname}}" name="lastname" class="form-control" id="lastname" aria-describedby="emailHelp" placeholder="lastname">
                        </div>
                        <input type="hidden" ngModel="{{edituser?.id}}" name="id" class="form-control" id="id" placeholder="Email">
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input required type="email" ngModel="{{edituser?.email}}" name="email" class="form-control" id="email" placeholder="Email">
                        </div>
                        <div class="form-group">
                            <label for="email">password</label>
                            <input required type="password" ngModel minlength="6" name="password" class="form-control" id="email" placeholder="password">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone</label>
                            <input required type="text" ngModel="{{edituser?.phone}}" name="phone" class="form-control" id="phone" name="phone" placeholder="Phone">
                        </div>
                        <div class="form-group">
                            <label for="phone">City</label>
                            <input required type="text" ngModel="{{edituser?.city}}" name="city" class="form-control" id="city" placeholder="city">
                        </div>
                        <div class="modal-footer">
                            <button type="button" id="" data-dismiss="modal" class="btn btn-secondary">Close</button>
                            <button [disabled]="editForm.invalid" (click)="onUpdateUser(edituser?.id,editForm.value)" data-dismiss="modal" class="btn btn-primary">Save changes</button>
                            <!-- <div class="alert alert-info" *ngIf="editForm.invalid" role="alert">
                                <h4 class="alert-heading">write your password to save changes</h4>
                            </div> -->
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal fade" id="deleteEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModelLabel">Delete User</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
               </button>
                </div>
                <div class="modal-body">
                    <strong>Are you sure you want to delete {{deleteuser?.username}}?</strong>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                        <button (click)="onDeleteUser(deleteuser?.id!)" class="btn btn-danger" data-dismiss="modal">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- role Modal -->
<div class="modal fade" id="roleEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="participeModelLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="participeModelLabel">{{roleuser?.username}} Role</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
         </button>
            </div>
            <div class="modal-body">
                <!-- <button (click)="getuserrole(roleuser.id)" class="btn btn-danger" data-dismiss="modal">role</button> item
                *ngFor="let role of utilisateur.roles" {{ role?.name }} -->
                <!-- <h3>Le role de <span style="color:steelblue;">{{roleuser?.username}}</span> est <span *ngFor="let role of roleuser.roles">//{{ role?.name }}</span> ..</h3> -->
                <div class="modal-footer">
                    <button (click)="changetoadmin(roleuser.id)" class="btn btn-danger" data-dismiss="modal">Admin </button>
                    <button (click)="changetorand(roleuser.id)" class="btn btn-secondary" data-dismiss="modal">Randonneur </button>
                    <button (click)="changetouser(roleuser.id)" class="btn btn-success" data-dismiss="modal">User </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Notification for no Users -->
<div *ngIf="utilisateurs?.length == 0" class="col-lg-12 col-md-12 col-xl-12">
    <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">NO Users!</h4>
        <p>No Users were found.</p>
    </div>
</div>